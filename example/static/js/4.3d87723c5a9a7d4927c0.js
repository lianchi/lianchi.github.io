webpackJsonp([4],{"0+5M":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Icdr");a("GbHy"),a("4UDB"),a("Oq2I"),e.default={props:{id:{type:String,default:"compare-org"},width:{type:String,default:"90%"},height:{type:String,default:"600px"},chartData:{type:Array,default:function(){return[]}},orgOptions:{type:Array,default:function(){return[]}}},data:function(){return{events:{backgroundColor:"transparent",tooltip:{confine:!0,formatter:function(t){var e=t.data;return e.name+"<br>事件类型： "+e.event+"<br>事件数： "+e.value}},grid:{left:-50,right:"5%",top:10,bottom:0,containLabel:!0},xAxis:{type:"log",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},yAxis:[{type:"category",data:[],axisLine:{show:!1},axisTick:{show:!1,alignWithLabel:!0},axisLabel:{show:!1,color:"#ffb069"}}],series:[{type:"bar",data:[],name:"事件数",barWidth:18,label:{normal:{show:!0,position:[0,-20],formatter:function(t){return t.data.event},textStyle:{color:"#838fa5"}}},itemStyle:{normal:{barBorderRadius:15,shadowColor:"transparent",color:new s.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#ffcdd2"},{offset:1,color:"#ef5055"}],!1)}}}]}}},mounted:function(){this.initChart()},methods:{initEvent:function(){for(var t=[],e=10;e>0;e--)t.unshift({name:"No."+(10-e+1),event:"test"+e,value:10*e+5});this.events.series[0].data=t},initChart:function(){var t=s.init(document.getElementById(this.id));this.initEvent(),t.setOption(this.events)}}}},"2Zyo":function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a("zjk8"),r=s(i),o=a("RSTb"),n=s(o),l=a("RUjS"),c=a("0nCa"),d=a("5LfB"),u=a("9E5R");a("E4LH");e.default={components:{CompareDialog:r.default,CompareChart:n.default},props:["taskApi","compareType","compareId"],data:function(){return{taskStatus:{taskGoing:{type:"warning",className:"el-icon-time"},taskDone:{type:"success",className:"el-icon-circle-check"},taskTimeout:{type:"danger",className:"el-icon-remove"},taskFail:{type:"danger",className:"el-icon-circle-close"}},taskAnimate:"",dataAnimate:"slideInUp",showTaskPage:!0,datePickerOptions:{shortcuts:(0,c.dateShortcuts)(this)},dialogProps:{isVisible:!1,taskApi:this.taskApi,orgOptions:this.orgOptions},taskParams:{taskName:"",orgId1:"",orgId2:"",datetimerange:[]},orgOptions:[],taskData:[{displayName:"test"}],comparedOrgs:[{orgId:"1",orgName:"111",hostNum:"6,400",chartData:[]},{orgId:"2",orgName:"222",hostNum:"2,400",chartData:[]},{orgId:"3",orgName:"333",hostNum:"2,400",chartData:[]}],taskTableLoading:!1,currentPage:1,pageSize:10,pageSizes:[10,25,50],totalElements:0,chartData:{}}},mounted:function(){this.getOrgs()},methods:{currentChange:function(t){this.currentPage=t,this.getTask()},sizeChange:function(t){this.pageSize=t,this.getTask()},openTips:function(){this.$notify({title:"提示",message:"请先创建任务，当任务执行完毕后，方能查看分析数据。",position:"bottom-right"})},formatTime:function(t,e,a){return(0,c.formatStamp)(a)},getOrgs:function(){var t=this;d.rtaRequest.getOrgs().then(function(e){t.orgOptions=e.data})},changeVisible:function(){this.dialogProps.isVisible=!1},createTask:function(){this.dialogProps.isVisible=!0},isTimeout:function(t){return(Date.now()-1e3*Number(t))/1e3>900},getTask:function(){var t=this;this.taskTableLoading=!0;var e={type:this.taskApi,pageSize:this.pageSize,pageNum:this.currentPage-1};u.ofaRequest.ofaTask.get(e).then(function(e){var a=e.data.content;a.map(function(e){e.analysis?e.analysis=-1!==e.analysis.indexOf("error")?"taskFail":"taskDone":e.analysis=t.isTimeout(e.executeTime)?"taskTimeout":"taskGoing"}),t.taskData=a,t.totalElements=e.data.totalElements,t.taskTableLoading=!1}).catch(function(){t.taskTableLoading=!1})},deleteTask:function(t){var e=this;(0,l.confirmAlter)(this,"是否删除该任务?",{success:function(){u.ofaRequest.deleteTaskById(t.id).then(function(t){e.getTask(),e.$message({showClose:!0,message:"删除成功",type:"success"})})},cancel:function(t){}})},showData:function(t){var e=this;this.taskAnimate="slideOutUp",u.ofaRequest.getDataById(t.id).then(function(t){var a=t.data.analysis,s=a.orgInfomations.map(function(t){return t.orgId});s=s.map(function(t){if("null"==t)return"空";var a=e.orgOptions.find(function(e){return e.id==t});return void 0==a?"空":a.displayName})}),setTimeout(function(){e.showTaskPage=!1,e.taskAnimate="slideInDown"},50)},goBack:function(){var t=this;this.dataAnimate="slideOutDown",setTimeout(function(){t.showTaskPage=!0,t.dataAnimate="slideInUp"},0)}}}},AQSa:function(t,e,a){var s=a("vmow");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("757968d3",s,!0)},ARie:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("iOWT"),i=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={components:{CommonCompare:i.default},data:function(){return{compareProps:{taskApi:"COMPARE_ORG",compareType:"机构对比分析",compareId:"compare-host"}}}}},KzOr:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{width:"40%","before-close":t.hidden,visible:t.isVisible,title:"创建【机构对比】任务","close-on-click-modal":!1},on:{close:t.hidden,"update:visible":function(e){t.isVisible=e}}},[a("el-form",{ref:"addCompareForm",attrs:{"label-width":"100px",rules:t.rules,model:t.taskParams}},[a("el-form-item",{attrs:{label:"任务名称：",prop:"taskName"}},[a("el-input",{staticStyle:{width:"85%"},model:{value:t.taskParams.taskName,callback:function(e){t.$set(t.taskParams,"taskName","string"==typeof e?e.trim():e)},expression:"taskParams.taskName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"起止时间：",prop:"datetimerange"}},[a("el-date-picker",{staticStyle:{width:"85%"},attrs:{editable:!1,type:"datetimerange","start-placeholder":this.$t("date.startDate"),"end-placeholder":this.$t("date.endDate"),align:"left","unlink-panels":"","picker-options":t.datePickerOptions},model:{value:t.taskParams.datetimerange,callback:function(e){t.$set(t.taskParams,"datetimerange","string"==typeof e?e.trim():e)},expression:"taskParams.datetimerange"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"事件类型：",prop:"eventType"}},[a("el-select",{staticStyle:{width:"85%"},attrs:{filterable:"",clearable:"",multiple:"",placeholder:this.$tc("ofa.audit.eventType",2)},model:{value:t.taskParams.eventType,callback:function(e){t.$set(t.taskParams,"eventType",e)},expression:"taskParams.eventType"}},t._l(t.eventTypeOptions,function(t){return a("el-option",{key:t.event,attrs:{label:t.event,value:t.event}})}))],1),t._v(" "),t._l(t.orgs,function(e,s){return a("section",{key:s},[a("el-form-item",{attrs:{label:e.label,prop:e.prop}},[a("el-select",{staticStyle:{width:"85%"},attrs:{filterable:"",clearable:""},model:{value:t.taskParams[e.prop],callback:function(a){t.$set(t.taskParams,e.prop,"string"==typeof a?a.trim():a)},expression:"taskParams[item.prop]"}},t._l(t.orgOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.displayName,value:t.id}})}))],1)],1)})],2),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.hidden(e)}}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.submitLoading,expression:"submitLoading"}],attrs:{type:"primary"},nativeOn:{click:function(e){t.submit(e)}}},[t._v("提交\n            ")])],1)],1)],1)},i=[],r={render:s,staticRenderFns:i};e.a=r},RSTb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("0+5M"),i=a.n(s),r=a("oPTe"),o=a("VU/8"),n=o(i.a,r.a,!1,null,null,null);e.default=n.exports},"d+9C":function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),r=s(i),o=a("lHA8"),n=s(o),l=a("c/Tr"),c=s(l),d=a("9E5R"),u=a("RUjS"),m=a("0nCa"),p=a("E4LH");e.default={props:["isVisible","taskApi","orgOptions"],data:function(){return{datePickerOptions:{shortcuts:(0,m.dateShortcuts)(this)},eventTypeOptions:[],orgs:[{label:"机构 1：",prop:"org1"},{label:"机构 2：",prop:"org2"},{label:"机构 3：",prop:"org3"},{label:"机构 4：",prop:"org4"}],rules:{taskName:[{required:!0,message:this.$t("validate.default"),tigger:"blur"},{validator:p.validateForm.lessThan,message:this.$t("validate.lessThan")}],datetimerange:[{type:"array",required:!0,message:this.$t("validate.datetime"),tigger:"change"}]},taskParams:{taskName:"",org1:"",org2:"",org3:"",org4:"",datetimerange:[]},submitLoading:!1}},mounted:function(){this.getEventTypes()},methods:{getEventTypes:function(){var t=this;d.ofaRequest.eventType.get().then(function(e){t.eventTypeOptions=e.data.content})},submit:function(){var t=this;this.$refs.addCompareForm.validate(function(e){if(e){var a=[t.taskParams.orgId1,t.taskParams.orgId2,t.taskParams.orgId3,t.taskParams.orgId4];if((0,c.default)(new n.default(a)).length<=2)return void(0,u.alertMessage)(t,t.$t("validate.orglg2"));t.submitLoading=!0;var s={body:{type:t.taskApi,displayName:t.taskParams.taskName,startTime:Number(t.taskParams.datetimerange[0]),endTime:Number(t.taskParams.datetimerange[1]),argument:(0,r.default)({orgId1:t.taskParams.orgId1,orgId2:t.taskParams.orgId2,orgId3:t.taskParams.orgId3,orgId4:t.taskParams.orgId4})}};d.ofaRequest.ofaTask.add(s).then(function(e){t.$message({showClose:!0,message:"添加成功",type:"success"}),t.submitLoading=!1,t.hidden(),t.$emit("addTaskDone")}).catch(function(){t.submitLoading=!1})}})},hidden:function(){this.taskParams={taskName:"",orgId1:"",orgId2:"",orgId3:"",orgId4:"",datetimerange:[]},this.$emit("updateIsVisible",!1)}}}},iOWT:function(t,e,a){"use strict";function s(t){a("AQSa")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("2Zyo"),r=a.n(i),o=a("rfs7"),n=a("VU/8"),l=s,c=n(r.a,o.a,!1,l,"data-v-c69848ec",null);e.default=c.exports},kP2a:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;return(t._self._c||e)("CommonCompare",t._b({},"CommonCompare",t.compareProps,!1))},i=[],r={render:s,staticRenderFns:i};e.a=r},oPTe:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{style:{height:t.height,width:t.width},attrs:{id:t.id}})},i=[],r={render:s,staticRenderFns:i};e.a=r},rfs7:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.showTaskPage?a("div",{staticClass:"animated",class:t.taskAnimate},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus"},nativeOn:{click:function(e){t.createTask(e)}}},[t._v("\n\t\t\t\t"+t._s(t.$t("ofa.table.createTask"))+"\n\t\t\t")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-refresh"},nativeOn:{click:function(e){t.getTask(e)}}},[t._v("\n\t\t\t\t"+t._s(t.$t("ofa.table.refresh"))+"\n\t\t\t")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.taskTableLoading,expression:"taskTableLoading"}],ref:"taskTable",staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{data:t.taskData,stripe:"","show-overflow-tooltip":!0,"highlight-current-row":!0,"tooltip-effect":"dark","max-height":"680"}},[a("el-table-column",{attrs:{type:"index",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"displayName",label:this.$t("ofa.table.taskName"),"min-width":"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:this.$t("ofa.table.startDate"),"min-width":"120",formatter:t.formatTime}}),t._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:this.$t("ofa.table.endDate"),"min-width":"120",formatter:t.formatTime}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:this.$t("ofa.table.taskStatus"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.taskStatus[e.row.analysis].type}},[a("i",{class:t.taskStatus[e.row.analysis].className}),t._v(" "+t._s(t.$t("ofa.audit."+e.row.analysis))+"\n\t\t\t\t\t")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:this.$t("ofa.table.operation"),"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return["taskDone"===e.row.analysis?a("el-button",{staticClass:"show-task",attrs:{type:"text"},on:{click:function(a){t.showData(e.row)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.$t("ofa.audit.detail"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),a("el-button",{staticClass:"delete-task",attrs:{type:"text"},on:{click:function(a){t.deleteTask(e.row)}}},[t._v("\n\t\t\t\t\t\t"+t._s(t.$t("ofa.audit.delete"))+"\n\t\t\t\t\t")])]}}])})],1),t._v(" "),a("div",{staticClass:"common-toolbar-footer"},[a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalElements},on:{"current-change":t.currentChange,"size-change":t.sizeChange}})],1)],1):t._e(),t._v(" "),t.dialogProps.isVisible?a("CompareDialog",t._b({on:{addTaskDone:t.getTask,updateIsVisible:t.changeVisible}},"CompareDialog",t.dialogProps,!1)):t._e(),t._v(" "),t.showTaskPage?t._e():a("div",{staticClass:"animated",class:t.dataAnimate},[a("el-card",{staticClass:"compare-card"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-header"},[t._v(t._s(t.compareType))]),t._v(" "),a("el-button",{staticClass:"title-btn",attrs:{type:"text"},on:{click:t.goBack}},[t._v("返回")])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},t._l(t.comparedOrgs,function(e,s){return a("section",[a("el-col",{attrs:{span:24/t.comparedOrgs.length}},[a("div",{staticClass:"org-title"},[t._v(t._s(e.orgName))]),t._v(" "),a("div",{staticClass:"org-num"},[a("p",[t._v("用户总数： "+t._s(e.userNum))]),t._v(" "),a("p",[t._v("主机总数： "+t._s(e.hostNum))]),t._v(" "),a("p",[t._v("事件总数： "+t._s(e.eventNum))]),t._v(" "),a("p",[t._v("TopN 事件分布如下：")])]),t._v(" "),a("CompareChart",{attrs:{id:"compare-org"+e.orgId,chartData:e.chartData}})],1)],1)}))],1)],1)],1)},i=[],r={render:s,staticRenderFns:i};e.a=r},vmow:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".show-task[data-v-c69848ec]{color:#838fa5}.show-task[data-v-c69848ec]:hover{color:#13ce66}.delete-task[data-v-c69848ec]{color:#838fa5}.delete-task[data-v-c69848ec]:hover{color:#e57373}.compare-card[data-v-c69848ec]{height:800px;position:relative}.compare-card .title-btn[data-v-c69848ec]{padding:5px 0;margin-left:10px}.compare-card .el-card__body[data-v-c69848ec]{padding:0 10px}.org-title[data-v-c69848ec]{font-size:14px;font-weight:700;color:#838fa5;margin-left:40%}.org-num[data-v-c69848ec]{font-size:13px;font-weight:600;color:#838fa5;margin-left:16px;margin-bottom:10px}",""])},wHrS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("ARie"),i=a.n(s),r=a("kP2a"),o=a("VU/8"),n=o(i.a,r.a,!1,null,null,null);e.default=n.exports},zjk8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("d+9C"),i=a.n(s),r=a("KzOr"),o=a("VU/8"),n=o(i.a,r.a,!1,null,null,null);e.default=n.exports}});